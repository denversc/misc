name: markdown

on:
  workflow_dispatch:
    inputs:
      node-version:
        default: '22'
      markdownlint-cli2-version:
        default: '0.17.2'
  pull_request:
    paths:
      - '**/*.md'
      - '.github/workflows/markdown.yml'

env:
  ZQ88C5ADW6_NODE_VERSION: ${{ inputs.node-version || '22' }}
  ZQ88C5ADW6_MARKDOWNLINT_CLI2_VERSION: ${{ inputs.markdownlint-cli2-version || '0.17.2' }}

concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - name: git checkout
        uses: actions/checkout@v4
        with:
          show-progress: false

      - name: install node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ inputs.node-version }}

      - name: install markdownlint-cli2
        run: npm install --fund=false --audit=false --global 'markdownlint-cli2@${{ inputs.markdownlint-cli2-version }}'

      - name: run markdownlint-cli2
        run: markdownlint-cli2 '**/*.md'
